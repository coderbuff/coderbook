(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{224:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事务"}},[t._v("#")]),t._v(" 事务")]),t._v(" "),a("p",[t._v("我们在学习MySQL的存储殷勤时知道，MySQL中innodb支持事务而myisam不支持事务。而事务具有四个特性：")]),t._v(" "),a("ul",[a("li",[t._v("一致性")]),t._v(" "),a("li",[t._v("原子性")]),t._v(" "),a("li",[t._v("隔离性")]),t._v(" "),a("li",[t._v("持久性")])]),t._v(" "),a("p",[t._v("在redis尽管提供了事务相关的命令，但实际上它是一个“假事务”，因为它并不支持回滚，也就是说在redis中一个事务有多个命令执行，并不能保证原子性。所以要使用redis的事务，一定要"),a("strong",[t._v("慎重")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"redis中的-假事务-（不保证原子性）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis中的-假事务-（不保证原子性）"}},[t._v("#")]),t._v(" Redis中的“假事务”（不保证原子性）")]),t._v(" "),a("p",[t._v("在redis中事务相关的命令一共有以下几个：")]),t._v(" "),a("p",[a("code",[t._v("watch [key1] [key2]")]),t._v("：监视一个或多个key，在事务开始之前如果被监视的key有改动，则事务被打断。")]),t._v(" "),a("p",[a("code",[t._v("multi")]),t._v("：标记一个事务的开始。")]),t._v(" "),a("p",[a("code",[t._v("exec")]),t._v("：执行事务。")]),t._v(" "),a("p",[a("code",[t._v("discard")]),t._v("：取消事务的执行。")]),t._v(" "),a("p",[a("code",[t._v("unwatch")]),t._v("：取消监视的key。")]),t._v(" "),a("ul",[a("li",[t._v("正常执行事务")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> set name kevin\nQUEUED\n127.0.0.1:6379> set age 25\nQUEUED\n127.0.0.1:6379> get name\nQUEUED\n127.0.0.1:6379> set sex male\nQUEUED\n127.0.0.1:6379> exec\n1) OK\n2) OK\n3) "kevin"\n4) OK\n')])])]),a("ul",[a("li",[t._v("取消事务执行")])]),t._v(" "),a("p",[t._v("取消事务执行，命令将不会被执行。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> set name yulinfeng\nQUEUED\n127.0.0.1:6379> set age 26\nQUEUED\n127.0.0.1:6379> discard\nOK\n127.0.0.1:6379> get name\n"kevin"\n')])])]),a("ul",[a("li",[t._v("事务中的命令出现"),a("strong",[t._v("命令性错误")]),t._v("，类似Java的编译错误，执行事务时，所有的命令都不会被执行。")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> set name yulinfeng\nQUEUED\n127.0.0.1:6379> setget age 26\n(error) ERR unknown command `setget`, with args beginning with: `age`, `26`, \n127.0.0.1:6379> exec\n(error) EXECABORT Transaction discarded because of previous errors.\n127.0.0.1:6379> get name\n"kevin"\n')])])]),a("ul",[a("li",[t._v("事务中出现"),a("strong",[t._v("执行时错误")]),t._v("，类似Java的运行时异常，执行事务时，部分命令会被执行成功，也即是"),a("strong",[t._v("不保证原子性")]),t._v("。")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> incr name\nQUEUED\n127.0.0.1:6379> set age 26\nQUEUED\n127.0.0.1:6379> exec\n1) (error) ERR value is not an integer or out of range\n2) OK\n127.0.0.1:6379> get age\n"26"\n')])])]),a("ul",[a("li",[t._v("使用"),a("code",[t._v("watch")]),t._v("监视key在事务之前被改动，正常未被改动时的情况，所有命令正常执行。")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> watch name\nOK\n127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> set name yulinfeng\nQUEUED\n127.0.0.1:6379> set age 18\nQUEUED\n127.0.0.1:6379> exec\n1) OK\n2) OK\n127.0.0.1:6379> get age\n"18"\n')])])]),a("ul",[a("li",[t._v("使用"),a("code",[t._v("watch")]),t._v("监视key，此时在事务执行前key被改动，事务将取消不会执行所有命令。")])]),t._v(" "),a("p",[t._v("我们现在一个redis客户端中执行watch命令。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("127.0.0.1:6379> watch name\nOK\n")])])]),a("p",[t._v("此时我们打开另一个redis客户端，修改key=name的值。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("127.0.0.1:6379> set name kevin\nOK\n")])])]),a("p",[t._v("我们再次回到第一个客户端，开始输入事务的命令块。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("127.0.0.1:6379> multi\nOK\n127.0.0.1:6379> set name abc\nQUEUED\n127.0.0.1:6379> set age 1\nQUEUED\n127.0.0.1:6379> exec\n(nil)\n")])])]),a("p",[t._v("可看到通过"),a("code",[t._v("exec")]),t._v("执行事务时，事务并没有执行成功，而是返回“nil”。")]),t._v(" "),a("p",[t._v("Java中Jedis使用redis事务，则通过调用以下方法实现，具体命令可参照文档：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Test")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("testTransaction")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Jedis")]),t._v(" jedis "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getJedis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    jedis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("watch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Transaction")]),t._v(" transaction "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" jedis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("multi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    transaction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    transaction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    transaction"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"通过lua脚本保证redis的真事务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过lua脚本保证redis的真事务"}},[t._v("#")]),t._v(" 通过Lua脚本保证Redis的真事务")]),t._v(" "),a("p",[t._v("redis中自带的事务命令，最致命的前面已经多次提到，那就是"),a("strong",[t._v("不保证原子性")]),t._v("，所以在使用redis的事务时，一定要谨慎。")]),t._v(" "),a("p",[t._v("但如果我们一定要在redis中实现真正的事务应该怎么办呢？redis为我们提供了另外一种更为“灵活”的方式——"),a("strong",[t._v("Lua脚本")]),t._v("。")]),t._v(" "),a("p",[t._v("在这里当然并不会详细讲解Lua的语法规则，我们一步步来看在redis中如何执行Lua脚本，以及Lua是如何运用在redis保证事务的。")]),t._v(" "),a("p",[t._v("我们先用Lua脚本在redis中实现调用字符串的"),a("code",[t._v("set")]),t._v("命令，我们先看示例：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> eval "return redis.call(\'set\', KEYS[1], ARGV[1])" 1 company bat\nOK\n127.0.0.1:6379> get company\n"bat"\n')])])]),a("p",[a("code",[t._v("eval")]),t._v("是执行Lua脚本的命令，第二个参数是Lua脚本，第三个参数是一个数字表示一共有多少个key，第四个参数表示key值，第五个参数表示value值，"),a("code",[t._v("eval [lua scripts] [numskey] [key1] [key2] [value1] [value2] ……")]),t._v("。")]),t._v(" "),a("p",[t._v("接下来，我们来一个Lua脚本，脚本中包含写入name的值和age的值。")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('127.0.0.1:6379> eval "redis.call(\'set\', KEYS[1], ARGV[1]) redis.call(\'set\', KEYS[2], ARGV[2])" 2 name age kevin 25\n(nil)\n127.0.0.1:6379> get name\n"kevin"\n127.0.0.1:6379> get age\n"25"\n')])])]),a("p",[t._v("对于简单的Lua脚本通过命令行的方式直接编辑问题不大，但如果是比较复杂得Lua脚本，通常我们会单独写一个Lua脚本文件，然后载入它，例如以下示例：")]),t._v(" "),a("div",{staticClass:"language-lua extra-class"},[a("pre",{pre:!0,attrs:{class:"language-lua"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("local")]),t._v(" exist "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'exists'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KEYS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" exist "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" redis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'incr'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" KEYS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("nil")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),a("p",[t._v("我们将它保存为Lua脚本文件，执行以下命令：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("okevindeMacBook-Air:redis-5.0.7 okevin$ redis-cli --eval ~/Desktop/lua_test.lua view\n(nil)\n")])])]),a("p",[t._v("可以看到key=view并不存在，所以返回nil，如果此时我们在redis中定义了一个key=view的值，此时将返回以下信息：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("okevindeMacBook-Air:redis-5.0.7 okevin$ redis-cli --eval ~/Desktop/lua_test.lua view\n(integer) 2\n")])])]),a("h2",{attrs:{id:"jedis中如何载入lua脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jedis中如何载入lua脚本"}},[t._v("#")]),t._v(" Jedis中如何载入Lua脚本")]),t._v(" "),a("blockquote",[a("p",[t._v("有关本节的源码："),a("a",{attrs:{href:"https://github.com/yu-linfeng/redis5.x_tutorial/tree/master/code/jedis",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/yu-linfeng/redis5.x_tutorial/tree/master/code/jedis"),a("OutboundLink")],1)])]),t._v(" "),a("p",[t._v("在Jedis可以直接调用"),a("code",[t._v("Jedis")]),t._v("类的"),a("code",[t._v("eval")]),t._v("方法，第一个参数是Lua脚本，第二个参数是key值，第三个参数是value值。")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("testLua")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Jedis")]),t._v(" jedis "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RedisClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getJedis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" keys "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"age"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" values "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kevin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"25"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    jedis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"redis.call('set', KEYS[1], ARGV[1]) redis.call('set', KEYS[2], ARGV[2])\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" keys"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" values"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    jedis"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);