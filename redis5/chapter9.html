<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>实战：缓存雪崩、缓存穿透、缓存击穿 | CoderBook</title>
    <meta name="description" content="CoderBook">
    <meta name="generator" content="VuePress 1.3.0">
    
    
    <link rel="preload" href="/coderbook/assets/css/0.styles.b2da8d00.css" as="style"><link rel="preload" href="/coderbook/assets/js/app.bd0e8773.js" as="script"><link rel="preload" href="/coderbook/assets/js/2.2e9b2f22.js" as="script"><link rel="preload" href="/coderbook/assets/js/28.24baedb4.js" as="script"><link rel="prefetch" href="/coderbook/assets/js/10.6f377ed6.js"><link rel="prefetch" href="/coderbook/assets/js/11.f34c1c50.js"><link rel="prefetch" href="/coderbook/assets/js/12.d8b974da.js"><link rel="prefetch" href="/coderbook/assets/js/13.4f10c2cc.js"><link rel="prefetch" href="/coderbook/assets/js/14.07641015.js"><link rel="prefetch" href="/coderbook/assets/js/15.11341f4e.js"><link rel="prefetch" href="/coderbook/assets/js/16.a1027f62.js"><link rel="prefetch" href="/coderbook/assets/js/17.b0b7317a.js"><link rel="prefetch" href="/coderbook/assets/js/18.42995780.js"><link rel="prefetch" href="/coderbook/assets/js/19.e405f35e.js"><link rel="prefetch" href="/coderbook/assets/js/20.f13e781b.js"><link rel="prefetch" href="/coderbook/assets/js/21.ecee6efb.js"><link rel="prefetch" href="/coderbook/assets/js/22.a5802306.js"><link rel="prefetch" href="/coderbook/assets/js/23.d28e9e5c.js"><link rel="prefetch" href="/coderbook/assets/js/24.0abc3809.js"><link rel="prefetch" href="/coderbook/assets/js/25.6a2ddf93.js"><link rel="prefetch" href="/coderbook/assets/js/26.4c465923.js"><link rel="prefetch" href="/coderbook/assets/js/27.7b30b08b.js"><link rel="prefetch" href="/coderbook/assets/js/29.f282ec3c.js"><link rel="prefetch" href="/coderbook/assets/js/3.d038ebcd.js"><link rel="prefetch" href="/coderbook/assets/js/30.f7e309d4.js"><link rel="prefetch" href="/coderbook/assets/js/4.9132518f.js"><link rel="prefetch" href="/coderbook/assets/js/5.8cde2cb8.js"><link rel="prefetch" href="/coderbook/assets/js/6.cf9f53d9.js"><link rel="prefetch" href="/coderbook/assets/js/7.a256c028.js"><link rel="prefetch" href="/coderbook/assets/js/8.2227699c.js"><link rel="prefetch" href="/coderbook/assets/js/9.fbfe90ec.js">
    <link rel="stylesheet" href="/coderbook/assets/css/0.styles.b2da8d00.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/coderbook/" class="home-link router-link-active"><!----> <span class="site-name">CoderBook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/coderbook/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/coderbook/es6/index.html" class="nav-link">
  ElasticSearch6.x
</a></div><div class="nav-item"><a href="/coderbook/redis5/index.html" class="nav-link">
  Redis5.x
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/coderbook/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/coderbook/es6/index.html" class="nav-link">
  ElasticSearch6.x
</a></div><div class="nav-item"><a href="/coderbook/redis5/index.html" class="nav-link">
  Redis5.x
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/coderbook/redis5/" class="sidebar-link">写在前面的话</a></li><li><a href="/coderbook/redis5/chapter1.html" class="sidebar-link">准备工作</a></li><li><a href="/coderbook/redis5/chapter2.html" class="sidebar-link">数据类型</a></li><li><a href="/coderbook/redis5/chapter3.html" class="sidebar-link">命令</a></li><li><a href="/coderbook/redis5/chapter4.html" class="sidebar-link">配置</a></li><li><a href="/coderbook/redis5/chapter5.html" class="sidebar-link">Java客户端（上）</a></li><li><a href="/coderbook/redis5/chapter6.html" class="sidebar-link">事务</a></li><li><a href="/coderbook/redis5/chapter7.html" class="sidebar-link">分布式锁</a></li><li><a href="/coderbook/redis5/chapter8.html" class="sidebar-link">Java客户端（下）</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="实战：缓存雪崩、缓存穿透、缓存击穿"><a href="#实战：缓存雪崩、缓存穿透、缓存击穿" class="header-anchor">#</a> 实战：缓存雪崩、缓存穿透、缓存击穿</h1> <h2 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h2> <p>缓存雪崩指的是缓存中有大量数据到了过期时间，数据库数据查询量增大，导致数据库压力过大宕机。</p> <p>既然是因为到了过期时间造成的数据库访问压力过大，所以自然地能想到通过设置<strong>永不过期</strong>就能避免缓存雪崩。当然设置永不过期是有代价的，这需要我们付出更多的内存空间。</p> <p>通常情况下，我们会设置<strong>随机过期时间</strong>，当然我们最好是根据不同的分类设置的过期时间。例如，热门的商品缓存时间更久一点，冷门的商品缓存时间段一点。</p> <h2 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h2> <p>穿透的含义是，请求穿过缓存直接请求数据库。对于正常的请求，这样的“穿透”是允许存在的。但如果是恶意的请求，故意请求不存在的值，例如ID=-1等，这样大量恶意请求到数据库，一样会造成数据库压力过大。</p> <p>解决的办法一是可以通过业务方式解决，例如，我们在业务层先验证值得有效性，过滤ID&lt;0的请求直接返回错误等。</p> <p>我们也能对非法的值，在请求到数据库后，将它写入缓存，这样在下次请求时就会直接访问到缓存，避免二次请求到数据库。</p> <h2 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h2> <p>缓存击穿主要是某一个key持续承担了大量的访问压力，在失效过期的瞬间导致所有请求全部请求到了数据库，同样造成数据库的压力。</p> <p>这样的场景，最简单的办法仍然是设置key永不过期。有的解决办法是访问数据库操作加上互斥锁，我认为这样的操作有点过度，还不如加强对缓存的管理，并且可以实时监控key的压力情况以及失效过期情况，以便能动态的配置缓存的过期时间。</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/coderbook/assets/js/app.bd0e8773.js" defer></script><script src="/coderbook/assets/js/2.2e9b2f22.js" defer></script><script src="/coderbook/assets/js/28.24baedb4.js" defer></script>
  </body>
</html>
